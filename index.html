<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Banana Count ‚Äî Minimal Test</title>
<style>
  body{margin:0;font-family:Arial,Helvetica,sans-serif;background:#e9f7ef;color:#111}
  .wrap{max-width:980px;margin:18px auto;padding:14px}
  h1{margin:0 0 10px}
  .card{background:#fff;border-radius:18px;box-shadow:0 10px 26px rgba(0,0,0,.1);padding:18px;text-align:center}
  /* scene */
  #scene{
    position:relative;width:340px;height:260px;margin:10px auto;
    border-radius:16px;background:linear-gradient(#e8f7e4,#d4f0d2);
    box-shadow:0 8px 20px rgba(0,0,0,.12);overflow:hidden;
  }
  .ground{position:absolute;left:0;right:0;bottom:0;height:48px;background:#c5e1a5}
  .tree{position:absolute;font-size:64px;filter:drop-shadow(0 4px 6px rgba(0,0,0,.15))}
  .tree.left{left:28px;top:30px}
  .tree.right{right:28px;top:30px}
  .banana{position:absolute;font-size:26px;cursor:pointer;transition:transform .8s ease,opacity .8s ease}
  .banana.fall{transform:translateY(150px) rotate(20deg)}
  .banana.gone{opacity:0;pointer-events:none}
  /* monkey: idle png + sprite sheets (optional) */
  .monkey{position:absolute;bottom:10px;left:150px;width:56px;height:56px;display:flex;align-items:center;justify-content:center;transition:transform .6s ease}
  .monkey .idle{width:56px;height:56px;background:url('assets/images/monkey_sitting.PNG') no-repeat;background-size:56px 56px}
  .monkey .sprite{width:56px;height:56px;display:none;background-repeat:no-repeat;image-rendering:auto}
  .monkey.walk .idle{display:none}
  .monkey.walk .sprite{display:block;background-image:url('assets/images/monkey_walk_sprites.png');background-size:224px 56px;animation:walk .6s steps(4) infinite}
  @keyframes walk{from{background-position:0 0}to{background-position:-224px 0}}
  .monkey.chew .idle{display:none}
  .monkey.chew .sprite{display:block;background-image:url('assets/images/monkey_chew_sprites.png');background-size:168px 56px;animation:chew .45s steps(3) 1 forwards}
  @keyframes chew{from{background-position:0 0}to{background-position:-168px 0}}
  .bubble{position:absolute;left:50%;top:10px;transform:translateX(-50%);font-size:38px;font-weight:900;background:#fff;padding:6px 16px;border-radius:12px;box-shadow:0 6px 14px rgba(0,0,0,.12);animation:pop .55s ease}
  @keyframes pop{0%{transform:translateX(-50%) scale(.6);opacity:0}60%{transform:translateX(-50%) scale(1.1);opacity:1}100%{transform:translateX(-50%) scale(1)}}
</style>
</head>
<body>
  <div class="wrap">
    <h1>üçå Banana Count ‚Äî Minimal Test <small style="font-weight:400;color:#555">v15</small></h1>
    <div id="game" class="card"></div>
  </div>

<script>
let soundOn=false; // set to true if you want speech
function speak(txt){ try{ if(window.speechSynthesis && soundOn){ speechSynthesis.speak(new SpeechSynthesisUtterance(txt)); } }catch(e){} }

(function startBanana(){
  const age = '2‚Äì4';         // change to '4‚Äì6' to test 10 bananas
  const max = (age==='4‚Äì6')? 10 : 5;
  let count=0, walkReady=false, chewReady=false;

  // preload optional sprite sheets (ok if missing)
  const w=new Image(), c=new Image();
  w.onload=()=>walkReady=true; w.src='assets/images/monkey_walk_sprites.png';
  c.onload=()=>chewReady=true; c.src='assets/images/monkey_chew_sprites.png';

  const game = document.getElementById('game');
  game.innerHTML = `
    <h2 style="margin:0 0 6px">Tap the bananas. Monkey will eat them!</h2>
    <div id="scene" role="img" aria-label="Banana scene">
      <div class="tree left">üå≥</div>
      <div class="tree right">üå≥</div>
      <div id="monkey" class="monkey"><div class="idle"></div><div class="sprite"></div></div>
      <div class="ground"></div>
    </div>
    <p id="countTxt" style="margin-top:8px;font-weight:800">Count: 0 / ${max}</p>
  `;

  const scene=document.getElementById('scene');
  const monkey=document.getElementById('monkey');
  const sprite=monkey.querySelector('.sprite');
  const countTxt=document.getElementById('countTxt');

  function spawn(){
    count=0; countTxt.textContent=`Count: 0 / ${max}`;
    scene.querySelectorAll('.banana,.bubble').forEach(n=>n.remove());
    monkey.classList.remove('walk','chew');

    for(let i=0;i<max;i++){
      const left = i%2===0; const baseX = left?60:270;
      const x = baseX + (Math.random()*40-20);
      const y = 64 + Math.random()*30;
      const b=document.createElement('div');
      b.className='banana'; b.textContent='üçå';
      b.style.left=(x-10)+'px'; b.style.top=y+'px'; b.dataset.x=x;
      b.addEventListener('click', ()=>dropAndEat(b));
      scene.appendChild(b);
    }
  }

  function dropAndEat(el){
    if(el.classList.contains('fall')) return;
    const x=+el.dataset.x; el.classList.add('fall');

    const targetX=Math.min(300,Math.max(10,x-20));
    if(walkReady) monkey.classList.add('walk');
    monkey.style.transform=`translateX(${targetX-150}px)`;

    setTimeout(()=>{
      el.classList.add('gone');
      monkey.classList.remove('walk');

      if(chewReady){
        monkey.classList.add('chew');
        sprite.addEventListener('animationend', function onEnd(){ monkey.classList.remove('chew'); sprite.removeEventListener('animationend', onEnd); });
      }

      count++; countTxt.textContent=`Count: ${count} / ${max}`;
      const bub=document.createElement('div'); bub.className='bubble'; bub.textContent=count; scene.appendChild(bub);
      speak(String(count)); setTimeout(()=>bub.remove(),650);

      if(count===max){ setTimeout(spawn,800); }
    },620);
  }

  spawn();
})();
</script>
</body>
</html>
