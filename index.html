<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Monkey‚Äôs Jungle Quest</title>

<style>
  :root{
    --mint:#e9f7ef;
    --card:#ffffff;
    --shadow:0 10px 26px rgba(0,0,0,.10);
    --chip:#ecf1ee;
    --chip-active:#d7f0dd;
  }
  html,body{margin:0;padding:0;font-family:Arial,Helvetica,sans-serif;background:var(--mint);color:#111;}

  /* === Top bar === */
  .topbar{
    max-width:980px;margin:14px auto 20px;padding:10px 14px;
    display:flex;align-items:center;justify-content:space-between;
  }
  .brand{display:flex;align-items:center;gap:12px}
  .brand .logo{font-size:28px;line-height:1}
  .brand .title{font-size:18px;font-weight:800;line-height:1.1}
  .controls{display:flex;gap:10px;align-items:center}
  .chip{border:0;border-radius:28px;padding:8px 14px;background:var(--chip);font-weight:700;cursor:pointer}
  .chip.active{background:var(--chip-active)}

  /* === Poster menu card === */
.poster-card{
  max-width:980px;
  margin:0 auto 28px;
  padding:14px;
  background:#fff;
  border-radius:20px;
  box-shadow:var(--shadow);
}

.poster-wrap{
  position:relative;   /* <-- anchor for absolute hotspots */
  border-radius:14px;
  overflow:hidden;
}

.poster{ width:100%; display:block; user-select:none; -webkit-user-drag:none; }

/* hotspots ‚Äì absolute over the poster */
.hotspot{
  position:absolute;
  border:0;
  background:transparent;
  cursor:pointer;
  color:transparent;   /* hide text */
  outline:none;
  border-radius:50%;
}

/* tuned positions (you already used these numbers) */
.hs-banana{ left: 9%;  top: 42%; width: 26%; height: 15%; }
.hs-snake { right:9%;  top: 42%; width: 26%; height: 15%; }
.hs-memory{ left:14%;  top: 59%; width: 22%; height: 15%; }
.hs-puzzle{ left:39%;  top: 59%; width: 22%; height: 15%; }
.hs-hide  { left:64%;  top: 59%; width: 22%; height: 15%; }

/* (optional) show boxes while aligning
.debug .hotspot{ outline:2px solid rgba(0,160,255,.35); border-radius:16px; }
*/
  /* === Game area === */
  .card{
    max-width:980px;margin:0 auto 50px;background:#fff;border-radius:20px;
    box-shadow:var(--shadow);padding:24px;text-align:center
  }
  .card h2{margin:0 0 8px;font-size:28px}
  .card p{margin:0;font-size:18px;color:#333}
</style>
</head>
<!-- Add 'debug' to body to SEE hotspot boxes; remove it when aligned -->
<body class="debug">

  <div class="topbar">
    <div class="brand">
      <span class="logo">üêíüçå</span>
      <div class="title"><strong>Monkey‚Äôs</strong> Jungle Quest</div>
    </div>
    <div class="controls">
      <span>Age:</span>
      <button class="chip active" onclick="setAge('2‚Äì4', this)">2‚Äì4</button>
      <button class="chip" onclick="setAge('4‚Äì6', this)">4‚Äì6</button>
      <button id="soundBtn" class="chip" onclick="toggleSound()">üîà <span>Off</span></button>
    </div>
  </div>

<section class="poster-card" aria-label="Main menu">
  <div class="poster-wrap">
    <!-- use the actual file you uploaded: menu.PNG (case matters on GitHub Pages) -->
    <img class="poster" src="assets/images/menu.PNG" alt="Monkey‚Äôs Jungle Quest Menu">

    <!-- hotspots -->
    <button class="hotspot hs-banana" aria-label="Banana Math" onclick="go('banana')">Banana</button>
    <button class="hotspot hs-snake"  aria-label="Snake Game"  onclick="go('maze')">Snake</button>
    <button class="hotspot hs-memory" aria-label="Memory Game"  onclick="go('memory')">Memory</button>
    <button class="hotspot hs-puzzle" aria-label="Puzzle Game"  onclick="go('puzzle')">Puzzle</button>
    <button class="hotspot hs-hide"   aria-label="Hide & Seek"  onclick="go('hide')">Hide</button>
  </div>
</section>

  <div id="gameArea" class="card" role="region" aria-live="polite">
    <h2>Welcome!</h2>
    <p>Select a game above to start.</p>
  </div>

  <!-- Your existing JS (kept) -->
  <script src="monkey_movement.js"></script>

  <!-- Small helpers + safe fallbacks so clicks always show something -->
  <script>
    let currentAge='2‚Äì4', soundOn=false;

    function setAge(age, btn){
      currentAge = age;
      // toggle chip look (leave sound button alone)
      document.querySelectorAll('.controls .chip').forEach(c=>c.classList.remove('active'));
      btn.classList.add('active');
    }
    function toggleSound(){
      soundOn=!soundOn;
      document.querySelector('#soundBtn span').textContent = soundOn ? 'On' : 'Off';
    }

    // If your external JS defines starters, we‚Äôll call them.
    const starters={
      banana: () => window.startBanana?.(document.getElementById('gameArea'), currentAge, soundOn),
      maze:   () => window.startMaze?.(document.getElementById('gameArea'), currentAge, soundOn),
      memory: () => window.startMemory?.(document.getElementById('gameArea'), currentAge, soundOn),
      puzzle: () => window.startPuzzle?.(document.getElementById('gameArea'), currentAge, soundOn),
      hide:   () => window.startHideSeek?.(document.getElementById('gameArea'), currentAge, soundOn)
    };

    function go(game){
      const area=document.getElementById('gameArea');
      // Try your real game first
      if (starters[game] && starters[game]()!=null) return;

      // Fallback mini-screens so it never feels broken
      const titles={banana:'Banana Math', maze:'Snake Game', memory:'Memory Game', puzzle:'Puzzle Game', hide:'Hide & Seek'};
      area.innerHTML = `
        <h2>${titles[game]||'Game'}</h2>
        <p>Age: ${currentAge}${soundOn?' ‚Ä¢ Sound On':''}</p>
        <p style="margin-top:12px;color:#555">Game loads here.</p>
      `;
    }

    /* ---------- OPTIONAL: remove debug borders once aligned ----------- */
    // setTimeout(()=>document.body.classList.remove('debug'), 3000);
  </script>
  <script>
/* Tiny helpers */
function h(tag, attrs={}, html=''){
  const el = document.createElement(tag);
  Object.entries(attrs).forEach(([k,v]) => el.setAttribute(k,v));
  if (html) el.innerHTML = html;
  return el;
}
function mountClear(m){ while(m.firstChild) m.removeChild(m.firstChild); }

/* =========================
   1) Banana Math (ages aware)
   ========================= */
window.startBanana = function(mount, age='2‚Äì4'){
  mountClear(mount);
  const wrap = h('div', {style:'max-width:520px;margin:0 auto;'});
  const q = h('h2', {}, 'Banana Math');
  const p = h('p', {style:'font-size:18px;color:#444'}, 'Pick the right answer!');
  const box = h('div', {style:'display:flex;gap:12px;justify-content:center;flex-wrap:wrap;margin-top:12px;'});

  function newQ(){
    box.innerHTML = '';
    const easy = age.includes('2');
    const a = easy ? Math.floor(Math.random()*6)+1 : Math.floor(Math.random()*9)+2;
    const b = easy ? Math.floor(Math.random()*6)+1 : Math.floor(Math.random()*9)+2;
    const op = easy ? '+' : (Math.random()<0.5?'+':'‚àí');
    const correct = op==='+'? a+b : Math.max(a,b)-Math.min(a,b);
    q.innerHTML = 'üçå ' + a + ' ' + op + ' ' + (op==='+'?b:Math.min(a,b)) + ' = ?';

    const answers = new Set([correct]);
    while(answers.size<3) answers.add(correct + (Math.floor(Math.random()*7)-3) || 1);
    [...answers].sort(()=>Math.random()-0.5).forEach(v=>{
      const btn = h('button', {style:'min-width:96px;padding:12px 18px;border:0;border-radius:12px;background:#ffb703;color:#fff;font-weight:800;font-size:18px;'}, v);
      btn.onclick = ()=>{
        if(v===correct){
          btn.style.background='#38b000';
          speak('Great job!');
          setTimeout(newQ, 600);
        }else{
          btn.style.background='#d00000';
          speak('Try again');
        }
      };
      box.appendChild(btn);
    });
  }

  wrap.append(q,p,box);
  mount.appendChild(wrap);
  newQ();
};

/* Simple speech (respects your Sound toggle if you wire it) */
function speak(text){ try{ const u=new SpeechSynthesisUtterance(text); speechSynthesis.cancel(); speechSynthesis.speak(u);}catch{} }

/* =========================
   2) Snake Game (tiny maze)
   ========================= */
window.startMaze = function(mount){
  mountClear(mount);
  const W=8,H=6;
  const cells=[]; for(let y=0;y<H;y++){cells[y]=Array(W).fill('grass')}
  const start={x:1,y:H-2}, goal={x:W-2,y:1};
  const snakes = [];
  // place 6 random snake rocks away from start/goal
  while(snakes.length<6){
    const x=Math.floor(Math.random()*W), y=Math.floor(Math.random()*H);
    if((x===start.x&&y===start.y)||(x===goal.x&&y===goal.y)) continue;
    if(cells[y][x]==='grass'){cells[y][x]='snake';snakes.push({x,y});}
  }

  let pos={...start};
  const grid = h('div',{style:'display:grid;grid-template-columns:repeat('+W+',48px);gap:6px;justify-content:center;margin:12px auto;'});
  function draw(){
    grid.innerHTML='';
    for(let y=0;y<H;y++){
      for(let x=0;x<W;x++){
        let tile='üü©', bg='#e8f5e9';
        if(x===goal.x && y===goal.y){ tile='üçå'; bg='#fff3cd'; }
        if(cells[y][x]==='snake'){ tile='üêç'; bg='#ffe0b2'; }
        if(x===pos.x && y===pos.y){ tile='üêµ'; bg='#cfe9ff'; }
        const cell=h('div',{style:'width:48px;height:48px;display:grid;place-items:center;font-size:26px;background:'+bg+';border-radius:10px;user-select:none;'});
        cell.textContent=tile; grid.appendChild(cell);
      }
    }
  }

  const keys=h('div',{style:'display:flex;justify-content:center;gap:10px;margin-top:10px;'});
  ['‚¨ÖÔ∏è','‚¨ÜÔ∏è','‚¨áÔ∏è','‚û°Ô∏è'].forEach((k,i)=>{
    const b=h('button',{style:'padding:10px 12px;border:0;border-radius:12px;background:#90caf9;font-weight:800;font-size:20px;'},k);
    b.onclick=()=>{
      const d=[[-1,0],[0,-1],[0,1],[1,0]][i];
      const nx=Math.max(0,Math.min(W-1,pos.x+d[0]));
      const ny=Math.max(0,Math.min(H-1,pos.y+d[1]));
      if(cells[ny][nx]==='snake'){ speak('Hiss!'); return; }
      pos={x:nx,y:ny}; draw();
      if(pos.x===goal.x && pos.y===goal.y){ speak('Banana! You win!'); }
    };
    keys.appendChild(b);
  });

  mount.append(h('h2',{},'Snake Game'), grid, keys);
  draw();
};

/* =========================
   3) Memory (4x4)
   ========================= */
window.startMemory = function(mount){
  mountClear(mount);
  const icons=['ü¶ä','üêº','üê∏','ü¶Å','üê§','üê≥','ü¶Ñ','ü¶Ü'];
  const deck=[...icons,...icons].sort(()=>Math.random()-0.5);
  let open=[], matched=0, lock=false;

  const grid=h('div',{style:'display:grid;grid-template-columns:repeat(4,70px);gap:10px;justify-content:center;margin-top:12px;'});
  deck.forEach((ico,idx)=>{
    const card=h('button',{ 'data-ico':ico, 'data-open':'0', style:'width:70px;height:70px;border:0;border-radius:12px;background:#b2dfdb;font-size:34px;'},'‚ùì');
    card.onclick=()=>{
      if(lock || card.dataset.open==='1') return;
      card.dataset.open='1'; card.textContent=ico; open.push(card);
      if(open.length===2){
        lock=true;
        if(open[0].dataset.ico===open[1].dataset.ico){
          matched+=2; open.forEach(c=>c.style.background='#81c784'); open=[];
          lock=false; if(matched===deck.length){ speak('All matched!'); }
        }else{
          setTimeout(()=>{ open.forEach(c=>{c.dataset.open='0'; c.textContent='‚ùì'; c.style.background='#b2dfdb';}); open=[]; lock=false; },700);
        }
      }
    };
    grid.appendChild(card);
  });

  mount.append(h('h2',{},'Memory Game'), h('p',{style:'color:#555'},'Find all pairs!'), grid);
};

/* =========================
   4) Puzzle (2√ó3 swap)
   ========================= */
window.startPuzzle = function(mount){
  mountClear(mount);
  const pieces=['üß©','üß©','üß©','üß©','üß©','üß©']; // placeholder icons
  const order=[0,1,2,3,4,5].sort(()=>Math.random()-0.5);
  let first=null;

  const grid=h('div',{style:'display:grid;grid-template-columns:repeat(3,86px);gap:10px;justify-content:center;margin-top:12px;'});
  function draw(){
    grid.innerHTML='';
    order.forEach((id,i)=>{
      const b=h('button',{style:'width:86px;height:86px;border:0;border-radius:12px;background:#ffd6a5;font-size:40px;'},pieces[id]);
      b.onclick=()=>{
        if(first===null){ first=i; b.style.outline='3px solid #fb8500'; }
        else{
          const j=first; first=null;
          grid.querySelectorAll('button')[j].style.outline='none';
          [order[i],order[j]]=[order[j],order[i]];
          draw();
          if(order.every((v,idx)=>v===idx)){ speak('Puzzle solved!'); }
        }
      };
      grid.appendChild(b);
    });
  }
  mount.append(h('h2',{},'Puzzle Game'), h('p',{style:'color:#555'},'Tap two tiles to swap. Arrange them in order.'), grid);
  draw();
};

/* =========================
   5) Hide & Seek
   ========================= */
window.startHideSeek = function(mount){
  mountClear(mount);
  const animals=['ü¶Å','üêµ','ü¶ú','üêç','ü¶ã','üê∏'];
  const field=h('div',{style:'position:relative;height:300px;max-width:520px;margin:10px auto;background:#e6f4ea;border-radius:14px;overflow:hidden;box-shadow:0 4px 12px rgba(0,0,0,.08);'});
  let found=0;
  animals.forEach(a=>{
    const el=h('div',{style:'position:absolute;font-size:32px;cursor:pointer;transition:.2s;'},a);
    el.style.left=(Math.random()*85+5)+'%';
    el.style.top=(Math.random()*70+10)+'%';
    el.onclick=()=>{ if(el.style.opacity==='0.3')return; el.style.opacity='0.3'; found++; speak('Found one!'); if(found===animals.length) speak('You found them all!'); };
    field.appendChild(el);
  });
  mount.append(h('h2',{},'Hide & Seek'), h('p',{style:'color:#555'},'Tap all the animals you can find!'), field);
};
</script>
  <script>
/* =========================================================
   UTILITIES
========================================================= */
const $ = (sel, root=document) => root.querySelector(sel);
const $$ = (sel, root=document) => Array.from(root.querySelectorAll(sel));
const speak = (txt)=>{ try{ if(window.speechSynthesis && soundOn){
   const u = new SpeechSynthesisUtterance(txt); speechSynthesis.speak(u);
}}catch(e){} };

function makeCard(title, subtitle=''){
  return `
    <h2 style="margin:0 0 8px">${title}</h2>
    ${subtitle?`<p style="margin:0 0 14px;color:#4b4b4b">${subtitle}</p>`:''}
  `;
}

/* =========================================================
   üçå BANANA MATH
   Count the bananas and choose the right number
========================================================= */
window.startBanana = function(mount, age){
  const max = (age==='4‚Äì6')? 12 : 6;
  const doRound = ()=>{
    const n = Math.floor(Math.random()*max)+1;
    const opts = new Set([n]);
    while(opts.size<3){ opts.add( Math.max(1, Math.min(max, n + (Math.floor(Math.random()*5)-2))) );}
    const buttons = [...opts].sort((a,b)=>a-b).map(v =>
      `<button data-v="${v}" style="min-width:56px;margin:6px;padding:12px 14px;border:0;border-radius:12px;background:#ffd54f;font-weight:800;box-shadow:0 4px 10px rgba(0,0,0,.1)">${v}</button>`
    ).join('');
    mount.innerHTML = makeCard('üçå Banana Math',`Age: ${age}`) + `
      <div style="font-size:40px;line-height:1.2;margin:8px 0 6px">${'üçå'.repeat(n)}</div>
      <p style="margin:6px 0 10px">How many bananas?</p>
      <div>${buttons}</div>
      <div id="bananaMsg" style="margin-top:10px;font-weight:700"></div>
    `;
    $$('#gameArea button').forEach(b=>{
      b.addEventListener('click', ()=>{
        const v = +b.dataset.v;
        if(v===n){ $('#bananaMsg').textContent='Correct!'; speak('Correct!');
          setTimeout(doRound, 800);
        }else{ $('#bananaMsg').textContent='Try again'; speak('Try again'); }
      });
    });
  };
  doRound();
};

/* =========================================================
   üêç SNAKE MAZE
   Reach the ‚≠ê without hitting walls
========================================================= */
window.startMaze = function(mount, age){
  const size = (age==='4‚Äì6')? 11 : 9;       // grid size
  const stepMs = 110;                       // tick speed
  const cell = 28;                          // px
  let head = {x:1, y:1};
  let goal = {x:size-2, y:size-2};
  let dir = {x:1,y:0};
  let playing = true;

  // simple ring + a few blocks
  const grid = Array.from({length:size},(_,y)=>
    Array.from({length:size},(_,x)=> (x===0||y===0||x===size-1||y===size-1)?1:0)
  );
  // random obstacles
  const blocks = (age==='4‚Äì6')? 16 : 10;
  let placed = 0;
  while(placed<blocks){
    const x = 1+Math.floor(Math.random()*(size-2));
    const y = 1+Math.floor(Math.random()*(size-2));
    if((x===head.x&&y===head.y)||(x===goal.x&&y===goal.y)) continue;
    if(grid[y][x]===0){ grid[y][x]=1; placed++; }
  }
  grid[head.y][head.x]=0; grid[goal.y][goal.x]=0;

  mount.innerHTML = makeCard('üêç Snake Game','Reach the ‚≠ê without touching walls') + `
    <div id="mazeWrap" style="display:inline-block;background:#f7fff4;border-radius:12px;padding:8px;box-shadow:0 6px 16px rgba(0,0,0,.12)">
      <canvas id="maze" width="${size*cell}" height="${size*cell}" style="border-radius:8px"></canvas>
    </div>
    <div style="margin-top:10px;display:flex;justify-content:center;gap:10px">
      <button class="d" data-x="0" data-y="-1">‚¨ÜÔ∏è</button>
      <button class="d" data-x="-1" data-y="0">‚¨ÖÔ∏è</button>
      <button class="d" data-x="1" data-y="0">‚û°Ô∏è</button>
      <button class="d" data-x="0" data-y="1">‚¨áÔ∏è</button>
    </div>
  `;
  $$('#gameArea .d').forEach(b=>b.style.cssText='padding:10px 14px;border:0;border-radius:10px;background:#c8e6c9;font-weight:800');

  const ctx = $('#maze').getContext('2d');
  function draw(){
    ctx.clearRect(0,0,ctx.canvas.width,ctx.canvas.height);
    // ground
    ctx.fillStyle='#e6ffe0';
    ctx.fillRect(0,0,ctx.canvas.width,ctx.canvas.height);
    // walls
    ctx.fillStyle='#2e7d32';
    for(let y=0;y<size;y++) for(let x=0;x<size;x++){
      if(grid[y][x]) ctx.fillRect(x*cell,y*cell,cell,cell);
    }
    // goal
    ctx.fillStyle='#ffd54f';
    ctx.fillRect(goal.x*cell+6, goal.y*cell+6, cell-12, cell-12);
    // head
    ctx.fillStyle='#4caf50';
    ctx.beginPath();
    ctx.arc(head.x*cell+cell/2, head.y*cell+cell/2, cell*0.38, 0, Math.PI*2);
    ctx.fill();
  }
  function tick(){
    if(!playing) return;
    const nx=head.x+dir.x, ny=head.y+dir.y;
    if(grid[ny]?.[nx]){ playing=false; speak('Oops!'); alert('Oops! You hit a wall.'); return; }
    head={x:nx,y:ny};
    draw();
    if(head.x===goal.x && head.y===goal.y){ playing=false; speak('You win!'); setTimeout(()=>alert('You win!'),50); return; }
    setTimeout(tick, stepMs);
  }
  draw(); tick();
  $$('#gameArea .d').forEach(b=>b.addEventListener('click',()=>{
    dir={x: +b.dataset.x, y:+b.dataset.y};
  }));
  // swipe
  let sx,sy;
  $('#maze').addEventListener('touchstart',e=>{ const t=e.touches[0]; sx=t.clientX; sy=t.clientY; });
  $('#maze').addEventListener('touchend',e=>{
    const dx = e.changedTouches[0].clientX - sx;
    const dy = e.changedTouches[0].clientY - sy;
    if(Math.abs(dx)>Math.abs(dy)) dir={x: dx>0?1:-1, y:0}; else dir={x:0, y:dy>0?1:-1};
  });
};

/* =========================================================
   üß† MEMORY MATCH
========================================================= */
window.startMemory = function(mount, age){
  const pairs = (age==='4‚Äì6')? 6 : 4;
  const pool = ['ü¶Å','ü¶Ñ','ü¶ä','üêµ','üê∏','ü¶ã','üå∏','üçÑ','üçå','ü¶ì'];
  const icons = pool.slice(0,pairs);
  const deck = [...icons, ...icons].sort(()=>Math.random()-0.5);
  let first=null, lock=false, found=0, moves=0;

  mount.innerHTML = makeCard('üß† Memory Game',`Find all ${pairs} pairs`) + `
    <div id="grid" style="display:grid;grid-template-columns:repeat(4,78px);gap:10px;justify-content:center;margin-top:8px"></div>
    <p id="moves" style="margin-top:10px">Moves: 0</p>
  `;
  const g = $('#grid');
  deck.forEach((ico,i)=>{
    const el = document.createElement('button');
    el.className='card';
    el.dataset.icon = ico;
    el.style.cssText='width:78px;height:78px;border:0;border-radius:12px;background:#90caf9;font-size:0;box-shadow:0 6px 12px rgba(0,0,0,.12)';
    el.innerHTML = `<span style="font-size:44px;display:none">${ico}</span>`;
    el.addEventListener('click',()=>{
      if(lock || el.classList.contains('done') || $('span',el).style.display==='block') return;
      $('span',el).style.display='block';
      moves++; $('#moves').textContent='Moves: '+moves;
      if(!first){ first=el; return; }
      // second
      if(first.dataset.icon===el.dataset.icon){
        first.classList.add('done'); el.classList.add('done');
        found++; speak('Match');
        if(found===pairs) setTimeout(()=>{ speak('Great job!'); alert('Great job!'); }, 200);
        first=null;
      }else{
        lock=true; setTimeout(()=>{ $('span',first).style.display='none'; $('span',el).style.display='none'; first=null; lock=false; }, 700);
      }
    });
    g.appendChild(el);
  });
};

/* =========================================================
   üß© PUZZLE (3√ó2 for 2‚Äì4, 3√ó3 for 4‚Äì6) ‚Äî drag to reorder
   Uses background-position slices of the monkey image
========================================================= */
window.startPuzzle = function(mount, age){
  const rows = (age==='4‚Äì6')? 3 : 2;
  const cols = (age==='4‚Äì6')? 3 : 3;
  const img = 'assets/images/monkey_sitting.PNG';
  const W = 300, H = rows===2? 240 : 300;

  mount.innerHTML = makeCard('üß© Puzzle Game', `Drag the tiles to fix the picture`) + `
    <div id="pz" style="width:${W}px;margin:10px auto;display:grid;grid-template-columns:repeat(${cols},1fr);gap:6px"></div>
  `;
  const pz = $('#pz');
  const tiles=[];
  for(let r=0;r<rows;r++) for(let c=0;c<cols;c++){
    const i = r*cols+c;
    const div = document.createElement('div');
    div.className='t'; div.draggable=true; div.dataset.correct=i;
    div.style.cssText=`width:${Math.floor((W-(cols-1)*6)/cols)}px;height:${Math.floor((H-(rows-1)*6)/rows)}px;border-radius:8px;background:#eee;background-image:url('${img}');background-size:${W}px ${H}px;background-position:${-c* (W/cols)}px ${-r*(H/rows)}px;box-shadow:0 4px 10px rgba(0,0,0,.12)`;
    tiles.push(div);
  }
  tiles.sort(()=>Math.random()-0.5).forEach(el=>pz.appendChild(el));

  let drag=null;
  pz.addEventListener('dragstart',e=>drag=e.target);
  pz.addEventListener('dragover',e=>e.preventDefault());
  pz.addEventListener('drop',e=>{
    e.preventDefault();
    const target = e.target.closest('.t'); if(!target || target===drag) return;
    const a = Array.from(pz.children).indexOf(drag);
    const b = Array.from(pz.children).indexOf(target);
    if(a<b) pz.insertBefore(target, drag); else pz.insertBefore(drag, target);
    checkWin();
  });
  function checkWin(){
    const ok = $$('.t', pz).every((el,idx)=> +el.dataset.correct===idx);
    if(ok){ speak('Puzzle complete'); setTimeout(()=>alert('Puzzle complete!'), 100); }
  }
};

/* =========================================================
   üëÄ HIDE & SEEK ‚Äî find all animals
========================================================= */
window.startHideSeek = function(mount, age){
  const animals = age==='4‚Äì6' ? ['ü¶Å','üêµ','ü¶ä','ü¶ì','ü¶â'] : ['üêµ','ü¶ä','ü¶â'];
  mount.innerHTML = makeCard('üëÄ Hide & Seek', 'Tap all the animals hidden in the field') + `
    <div id="field" style="position:relative;width:320px;height:220px;margin:10px auto;border-radius:14px;background:linear-gradient(#e8f7e4,#d4f0d2);box-shadow:0 6px 16px rgba(0,0,0,.12);overflow:hidden"></div>
    <p id="foundTxt">Found: 0 / ${animals.length}</p>
  `;
  const f = $('#field');
  let found=0;
  // bushes
  for(let i=0;i<26;i++){
    const b = document.createElement('div');
    b.textContent='üåø';
    b.style.cssText=`position:absolute;left:${Math.random()*280}px;top:${Math.random()*180}px;font-size:${20+Math.random()*16}px;opacity:.55`;
    f.appendChild(b);
  }
  // animals
  animals.forEach(a=>{
    const el = document.createElement('button');
    el.textContent = a;
    el.style.cssText = 'position:absolute;border:0;background:transparent;font-size:30px;cursor:pointer';
    el.style.left = (10+Math.random()*260)+'px';
    el.style.top  = (10+Math.random()*160)+'px';
    el.addEventListener('click',()=>{
      el.style.opacity='.25';
      el.disabled=true;
      found++; $('#foundTxt').textContent=`Found: ${found} / ${animals.length}`;
      speak('Found one');
      if(found===animals.length){ speak('You found them all'); setTimeout(()=>alert('You found them all!'),100); }
    });
    f.appendChild(el);
  });
};
</script>
</body>
</html>
